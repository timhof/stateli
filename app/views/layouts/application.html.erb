<!DOCTYPE html>

<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=UTF-8" />
  <title>Stateli Personal Finance</title>
  
  <%= javascript_include_tag 'swfobject' %>
  
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.1/build/reset-fonts-grids/reset-fonts-grids.css" />
  <link rel="stylesheet" type="text/css" href="http://yui.yahooapis.com/2.8.1/build/base/base-min.css" />
  <%= stylesheet_link_tag 'scaffold' %>
  <link type="text/css" rel="stylesheet" media="screen" href="/javascripts/dataTables-1.6/media/css/demo_page.css" />
  <link type="text/css" rel="stylesheet" media="screen" href="/javascripts/dataTables-1.6/media/css/demo_table.css" />
  <link type="text/css" href="/javascripts/development-bundle/themes/base/jquery.ui.all.css" rel="stylesheet" />
  
  <%= javascript_include_tag 'dataTables-1.6/media/js/jquery.js' %>
  <%= javascript_include_tag 'dataTables-1.6/media/js/jquery.dataTables.js' %>
  <%= javascript_include_tag 'development-bundle/external/jquery.bgiframe-2.1.1.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.core.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.widget.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.mouse.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.draggable.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.position.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.resizable.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.dialog.js' %>
  <%= javascript_include_tag 'development-bundle/ui/jquery.ui.datepicker.js' %>
  <%= javascript_include_tag 'jquery.safeEnter.js' %>

  <%= stylesheet_link_tag 'bank' %>
  
  <% if protect_against_forgery? %>
  	<script type='text/javascript'>
  	//<![CDATA[
	        window._auth_token_name = "#{request_forgery_protection_token}";
	        window._auth_token = "#{form_authenticity_token}";
    //]]>
	</script>
<% end %>
  <%= javascript_include_tag 'application.js' %>
  
</head>
<body>

<div id="main_div">
	<div id="welcome_div">
		
<% unless current_user.nil? %>
		<div style="float: left;">
			Welcome <%= current_user.login %>
		</div>
<% end %>
		<div id="login_form_div">
<% if current_user.nil? %>
			<% form_tag session_path do -%>
	 			<div id="new_session_login">
		  			<div class="login_form_label">Login</div>
			    	<div class="login_form_value">
			    		<%= text_field_tag 'login', @login, {:class => "base_form_field", :size => "15"} %>
			    	</div>
			  	</div>
			  	<div id="new_session_password">
				  	<div class="login_form_label">
				   		Password
				    </div>
				    <div class="login_form_value">
				    	<%= password_field_tag 'password', nil,  {:class => "base_form_field", :size => "15"} %>
				    </div>
			  	</div>
						  
				<!-- Uncomment this if you want this functionality
				<%= label_tag 'remember_me', 'Remember me' %>
				<%= check_box_tag 'remember_me', '1', @remember_me %>
				-->
				<div id="login_button_div">
					<%= submit_tag 'Log in', :class=> 'login_button'%>
				</div>
				<%= link_to_remote 'sign up', {:url => signup_path, :method => :get}, :class => 'listing_link' %>
				<div style="clear: both;"><!-- clearing div --></div>
					
			<% end -%>
<% else %>
			<div id="logout_div"><%= link_to "Log Out", logout_path %></div>
<% end %>
		</div><!-- login_form_div -->
	</div><!-- welcome_div -->

	<div id="hd" class="header">
		StateLi Personal Finance
	</div>
	<div id="bd">
		<div> 
			<div id="menu">
				<div class="menu_button">
					Accounts 
					[<%= link_to 'List', accounts_path, {:class => 'menu_link', :title => 'New Account'} %>]
					[<%= link_to 'New', new_account_path, {:class => 'menu_link', :title => 'New Account'} %>]
				</div>
			 <% 	unless current_user.nil?
	        		Account.activeAccounts(current_user.id).each do |account| %>
		 		<div id="account_title_div_<%= account.id %>" class="submenu_button" onclick="click_navigation('<%= account_path(account) %>',<%= current_user.nil? %>)"><%= h account.name %></div>
		 		<div id="account_options_div_<%= account.id %>" class="account_options_div">
			 		<div class="sub_submenu_button" onclick="click_navigation('<%= account_show_upload_path(account.id) %>',<%= current_user.nil? %>)">Upload CSV</div>
			 		
					<div class="sub_submenu_button" onclick="click_navigation('<%= account_path(account) %>',<%= current_user.nil? %>)">Account Details</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= account_deposit_path(account.id) %>',<%= current_user.nil? %>)">Deposit</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= account_withdraw_path(account.id) %>',<%= current_user.nil? %>)">Withdraw</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= edit_account_path(account) %>',<%= current_user.nil? %>)">Edit Account</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= account_journal_path(account.id) %>',<%= current_user.nil? %>)">Journal</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= month_pocket_totals_path(account.id) %>',<%= current_user.nil? %>)">Pocket Totals</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= account_remove_all_transactions_path(account.id) %>',<%= current_user.nil? %>)">Clear Transactions</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= account_rules_path(account) %>',<%= current_user.nil? %>)">Show Rules</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= account_apply_rules_path(account.id) %>',<%= current_user.nil? %>)">Apply Rules</div>
					<div class="sub_submenu_button" onclick="click_navigation('<%= new_account_rule_path(account.id) %>',<%= current_user.nil? %>)">Add Rule</div>
				</div>
		 	<% 		end
		 		end %>
				
				<div class="menu_button" onclick="click_navigation('<%= pockets_path %>',<%= current_user.nil? %>)">
					Pockets
					[<%= link_to 'List', pockets_path, {:class => 'menu_link', :title => 'New Account'} %>]
					[<%= link_to 'New', new_pocket_path, {:title => 'New Pocket', :class => "get"} %>]
				</div>
			</div>
	        <div style="width:80%;float:left;"> 
				<div id="flashdiv"><%= flash[:notice] %></div>
				<div id="template_div">
					<%= yield %>
				</div>
			</div>
		</div>
	</div>

</div>

<% unless @account.nil? %>

<div onclick="javascript:toggle_date_selectors();" style="display:none;">Toggle Dates</div>
<div id="date_selectors" style="display:none;">
	<div type="text" id="startDate" style="display:inline;float:left;margin:10px;"></div>
	<div type="text" id="endDate" style="display:inline;float:left;margin:10px;"></div>
</div>

<% end %>


<div id="edit_transaction_dialog" title="Edit Transaction" style="display:none;"></div>
<div id="edit_pocket_dialog" title="Edit Pocket" style="display:none;"></div>

</body>

<script type="text/javascript">
  	$(document).ready(function() {
		$('.menu_button').mouseover(function(){
			$(this).addClass('menu_mouseover');
		});
		$('.submenu_button').mouseover(function(){
			$(this).addClass('submenu_mouseover');
		});
		$('.sub_submenu_button').mouseover(function(){
			$(this).addClass('submenu_mouseover');
		});
		$('.menu_button').mouseout(function(){
			$(this).removeClass('menu_mouseover');
		});
		$('.submenu_button').mouseout(function(){
			$(this).removeClass('submenu_mouseover');
		});
		$('.sub_submenu_button').mouseout(function(){
			$(this).removeClass('submenu_mouseover');
		});
		$('.button').mouseover(function(){
			$(this).addClass('button_mouseover');
		});
		$('.button').mouseout(function(){
			$(this).removeClass('button_mouseover');
		});
		$('.account_options_div').hide();
	<%	unless @account.nil? %>
		$('#account_options_div_<%= @account.id %>').show();
		$('#account_title_div_<%= @account.id %>').addClass('account_selected');
	<%	end %>
  	} );
</script>

</html>


